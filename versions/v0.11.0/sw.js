import{ENABLED,VERSION,PREPEND,INDEX,PATHS}from"./config"
if(0==ENABLED&&(self.addEventListener("install",()=>{self.skipWaiting()}),self.addEventListener("activate",()=>{self.clients.matchAll().then(e=>{e.forEach(e=>{e.navigate(e.url)})})})),1==ENABLED){const e=PATHS.map(e=>new URL(e,PREPEND||self.location).toString())
self.addEventListener("message",e=>{"skipWaiting"===e.data&&(self.skipWaiting(),self.clients.claim())}),self.addEventListener("install",e=>{e.waitUntil(caches.open(`ember-app-${VERSION}`).then(e=>e.add(INDEX)))}),self.addEventListener("install",t=>{t.waitUntil(caches.open(`ember-app-${VERSION}`).then(t=>t.addAll(e)))}),self.addEventListener("activate",e=>{caches.keys().then(e=>{e.forEach(e=>{0===e.indexOf("ember-app")&&-1===e.indexOf(VERSION)&&caches.delete(e)})})}),self.addEventListener("fetch",t=>{let n=t.request,a=new URL(n.url)
"GET"===n.method&&-1===e.indexOf(n.url)&&a.origin===location.origin&&-1!==n.headers.get("accept").indexOf("text/html")&&t.respondWith(caches.open(`ember-app-${VERSION}`).then(e=>e.match(INDEX).then(e=>e).catch(e=>fetch(n).then(e=>e))))}),self.addEventListener("fetch",t=>{let n=t.request
"GET"===n.method&&-1!==e.indexOf(n.url)&&t.respondWith(caches.open(`ember-app-${VERSION}`).then(e=>e.match(n).then(t=>t||fetch(n).then(t=>(e.put(n,t.clone()),t)))))})}